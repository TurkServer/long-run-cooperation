<template name="game">
  <div class="row marketing">
    <div class="col-lg-12">

      {{#if invited}}
      <div class="alert alert-success alert-dismissible" role="alert">
	<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
	You have been automatically matched to a game.
      </div>
      {{/if}}

      <h4>Game {{gameNum}}</h4>
        <p>The table below shows the number of points associated with each possible combination of your choice and the choice of your opponent. In each cell, the first number is the number of points you will receive, and the second number is the number of points your opponent will receive.
	  {{> payoffTable}}
	</p>
      
      {{#if showPrevious}}
      Previous choices and outcomes:

      <table class="table table-bordered">
	<tbody>
	  <tr>
	    <td><strong>Round</strong></td>
	    <td><strong>Your Choice</strong></td>
	    <td><strong>Opponent's Choice</strong></td>
	    <td><strong>Your Payoff</strong></td>
	    <td><strong>Opponent's Payoff</strong></td>
	  </tr>
	  {{#each results}}
	  <tr>
	    <td>{{round_}}</td>
	    <td><span class="{{pchoice_color}}">{{pchoice}}</span></td>
	    <td><span class="{{ochoice_color}}">{{ochoice}}</span></td>
	    <td>{{pscore}}</td>
	    <td>{{oscore}}</td>
	  </tr>
	  {{/each}}
	  <tr>
	    <td colspan="3" class="align-right"><strong>Total Points</strong></td>
	    <td>{{payoffs.you}}</td>
	    <td>{{payoffs.opponent}}</td>
	  </tr>
	</tbody>
      </table>
      {{/if}}

      <!-- {{#if opponentOffline}} -->
      <!-- <div class="alert alert-warning" role="alert"> -->
      <!-- 	Your opponent has disconnected. You can wait for them to return, or <a class="abandon" href="#">click here</a> to abandon the game and return to the lobby. -->
      <!-- </div> -->
      <!-- {{/if}} -->

      {{#if offline}}
      {{> submit}}
      {{else}}
      {{#if playing}}
      {{#if pending}}
      <p>Make a choice for round {{round}}. You have {{roundWait}} seconds. After that, the HIT will be submitted automatically and you will receive partial payment.</p>
      {{else}}
      <p>Waiting on your opponent. After {{roundWait}} seconds have passed, the game will be terminated and you will be returned to the lobby.</p>
      {{/if}}
      <p>Seconds elapsed: {{timeSpent}} </p>
      <button type="button" class="btn btn-success cooperate {{#if turn_over}}disabled{{/if}}">Choice 1</button>
      <button type="button" class="btn btn-danger defect {{#if turn_over}}disabled{{/if}}">Choice 2</button>
      {{else}}
      <!-- <br/><strong>Results</strong>: -->
      <!-- Your total payoff is {{payoffs.you}} and your opponent's total payoff is {{payoffs.opponent}}. <br/><br/> -->
      {{#if notDone}}
      <button type="button" class="btn btn-default return">Return to Waiting Room</button>
      {{else}}
      You have finished your {{numGames}} games. Click the button below to submit the HIT.
      {{> submit}}
      {{/if}}
      {{/if}}
      {{/if}}
    </div>
  </div>
</template>
