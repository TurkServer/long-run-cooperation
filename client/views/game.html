<template name="game">
  <div class="row marketing">
    <div class="col-lg-12">
      <h4>Game {{gameNum}}</h4>
      <p> The payoff table is shown below. Recall that in each cell, the first number represents your payoff, and the second number represents the payoff of your opponent.
	{{> payoffTable}}
      </p>
      {{#if invited}}
      <div class="alert alert-success alert-dismissible" role="alert">
	<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
	You've been automatically matched to a game.
      </div>
      {{/if}}
      
      {{#if showPrevious}}
      Previous choices and outcomes:

      <table class="table table-bordered">
	<tbody>
	  <tr>
	    <td><strong>Round</strong></td>
	    <td><strong>Your Choice</strong></td>
	    <td><strong>Opponent's Choice</strong></td>
	    <td><strong>Your Payoff</strong></td>
	    <td><strong>Opponent's Payoff</strong></td>
	  </tr>
	  {{#each results}}
	  <tr>
	    <td>{{round_}}</td>
	    <td><span class="{{pchoice_color}}">{{pchoice}}</span></td>
	    <td><span class="{{ochoice_color}}">{{ochoice}}</span></td>
	    <td>{{pscore}}</td>
	    <td>{{oscore}}</td>
	  </tr>
	  {{/each}}
	  <tr>
	    <td colspan="3" class="align-right"><strong>Total Payoff So Far</strong></td>
	    <td>{{payoffs.you}}</td>
	    <td>{{payoffs.opponent}}</td>
	  </tr>
	</tbody>
      </table>
      {{/if}}

      {{#if opponent_offline}}
      <div class="alert alert-warning" role="alert">
	Your opponent has disconnected. You can wait for them to return, or <a class="abandon" href="#">click here</a> to abandon the game and return to the lobby.
      </div>
      {{/if}}

      {{#if playing}}
      {{#if pending}}
      Make a choice for round {{round}}.
      {{else}}
      Waiting on your opponent.
      {{/if}}<br/>
      After a minute has passed, the game will be terminated and you and your opponent will be returned to the lobby. <br/>
      Seconds elapsed: {{timeSpent}} <br/>
      <button type="button" class="btn btn-success cooperate {{#if turn_over}}disabled{{/if}}">Choice 1</button>
      <button type="button" class="btn btn-danger defect {{#if turn_over}}disabled{{/if}}">Choice 2</button>
      {{else}}
      <br/><strong>Results</strong>:
      Your total payoff is {{payoffs.you}} and your opponent's total payoff is {{payoffs.opponent}}. <br/><br/>
      {{#if notDone}}
      <button type="button" class="btn btn-default return">Return to Waiting Room</button>
      {{else}}
      You have finished your 20 games.
      {{> submit}}
      {{/if}}
      {{/if}}
    </div>
  </div>
</template>
